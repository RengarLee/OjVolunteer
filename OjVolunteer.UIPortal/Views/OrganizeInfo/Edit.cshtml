@model OjVolunteer.Model.OrganizeInfo

@{
    Layout = null;
}

<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>ITAEM</title>
    <link href="~/Content/layui/css/layui.css" rel="stylesheet" />
    <link href="~/Content/oj/css/admin.css" rel="stylesheet" />
    <script src="~/Content/oj/js/jquery-1.12.4.js"></script>
    <script src="~/Content/layui/layui.all.js"></script>
    <script src="~/Content/oj/js/admin.js"></script>
    <script src="~/Scripts/simple-ajax-form.js"></script>
    <script src="~/Scripts/jquery.validate.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.js"></script>
    <script type="text/javascript">
        $(function () {
            bindUpdateClick();

        });
        //用户点击确定
        function bindUpdateClick() {
            $("#btnUpdate").click(function () {
                $.post("/OrganizeInfo/Edit", $("#form1").serializeArray(), function (data) {
                    if (data != "ok") {
                        alert("资料修改出错，请稍后再试");
                        return;
                    } else {
                        var index = parent.layer.getFrameIndex(window.name);
                        parent.layer.close(index);
                        alert("资料修改成功");
                    }
                });
            });
        }


    </script>
</head>
<body>
    <header class="form-title">
        <h4>更改你的相关信息</h4>
    </header>
    <hr class="layui-bg-green">
    <div class="form-content">
        <form class="layui-form layui-form-pane" id="form1">
            @Html.HiddenFor(model => model.OrganizeInfoID)
            @Html.ValidationSummary(true)
            <div class="form-head clearfix">
                <div class="layui-upload form-head-left">
                    @Html.HiddenFor(model => model.OrganizeInfoIcon)
                    <div class="layui-upload-list">
                        <img class="layui-upload-img" src="@Model.OrganizeInfoIcon" id="myimg" name="UserInfoIcon" width="100px" height="120px">
                    </div>
                </div>
                <!--右半边-部分信息更改-->
                <div class="form-head-right">
                    <div class="layui-form-item">
                        <label class="layui-form-label">登录名</label>
                        <div class="layui-input-block">
                            @Html.EditorFor(model => model.OrganizeInfoLoginId, new { htmlAttributes = new { @class = "layui-input", type = "text", autocomplete = "off" } })
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">组织名称</label>
                        <div class="layui-input-block">
                            @Html.EditorFor(model => model.OrganizeInfoShowName, new { htmlAttributes = new { @class = "layui-input", type = "text", autocomplete = "off" } })
                            @*@Html.ValidationMessageFor(Model=>Model.OrganizeInfoShowName)*@
                        </div>
                    </div>

                </div>
            </div>

            <div class="form-foot">
                <div class="layui-form-item">
                    <label class="layui-form-label">负责人姓名</label>
                    <div class="layui-input-block">
                        @Html.EditorFor(model => model.OrganizeInfoPeople, new { htmlAttributes = new { @class = "layui-input", type = "text", autocomplete = "off" } })
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">手机号</label>
                    <div class="layui-input-block">
                        @Html.EditorFor(model => model.OrganizeInfoPhone, new { htmlAttributes = new { @class = "layui-input", type = "text", autocomplete = "off" } })
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">邮箱</label>
                    <div class="layui-input-block">
                        @Html.EditorFor(model => model.OrganizeInfoEmail, new { htmlAttributes = new { @class = "layui-input", type = "text", autocomplete = "off" } })
                    </div>
                </div>

            </div>
            @Html.HiddenFor(model => model.OrganizeInfoManageId)
            @Html.HiddenFor(model => model.OrganizeInfoLastTime)
            @Html.HiddenFor(model => model.CreateTime)
            @Html.HiddenFor(model => model.Remark)
            @Html.HiddenFor(model => model.Status)
            @Html.HiddenFor(model => model.OrganizeInfoPwd)
            <div class="form-btns">
                <button type="button" class="layui-btn" id="btnUpdate">确定</button>
                <button class="layui-btn" id="cancel" type="button">取消</button>
            </div>
        </form>
    </div>

    <script src="~/Content/layui/layui.all.js"></script>
    <script src="~/Content/oj/js/bootstrap.min.js"></script>
    <script src="~/Content/oj/js/main.js"></script>
    <script>
        layui.use('upload', function () {
            var upload = layui.upload;
            var uploadInst = upload.render({
                elem: '#myimg'
                , url: '/OrganizeInfo/UploadIcon' //上传接口
                , accept: 'images'
                , done: function (res) {
                    if (res["msg"] == "error") {
                        alert("头像更换失败，请稍后再试");
                    } else {
                        $("#myimg").attr("src", res["src"]);
                        alert("头像更新成功");
                    }
                }
                , error: function () {
                    alert("头像更换失败，请稍后再试")
                }
            });
        });

    </script>


</body>
</html>
